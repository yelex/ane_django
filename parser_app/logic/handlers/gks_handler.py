import os
from typing import Dict, Union

import pandas as pd
import urllib
import requests
from bs4 import BeautifulSoup
from datetime import datetime, date
import time

# TODO:
# - протестировать загрузку таблиц
# - формировать df по загруженной таблице
# - понять как делать запросы по кастомным отрезкам времени
# - ???
# - PROFIT!
# link - https://showdata.gks.ru/report/274422/?&filter_0_0=-17018&filter_1_0=2020-05-18+00%3A00%3A00%7C-58%2C2020-05-25+00%3A00%3A00%7C-58&filter_2_0=109543%2C109422%2C109423%2C109425%2C109517%2C109549%2C109427%2C109550%2C109428%2C109430%2C109518%2C109396%2C109397%2C109432%2C109435%2C109560%2C109561%2C109562%2C109563%2C109566%2C109444%2C109451%2C109577%2C109524%2C109402%2C109525%2C109526%2C109457%2C109459%2C109460%2C109463%2C109464%2C109466%2C109468%2C109469%2C109470%2C109471%2C109594%2C109595%2C109474%2C109597%2C109476%2C109726%2C110321%2C109530%2C217794%2C109744%2C109534%2C109652%2C109654%2C109781%2C109681%2C109688%2C109811%2C109692%2C109693%2C109816%2C109831%2C109715%2C109841%2C109842%2C109721%2C109723%2C109849%2C109854%2C110387%2C110389%2C109972%2C109900%2C109983%2C109901%2C109996%2C109418%2C110335%2C109944%2C109946%2C217805%2C110029%2C109947%2C110030%2C109948%2C110031%2C217787%2C110043%2C110045%2C110174%2C110175%2C110053%2C110057%2C110180%2C110181%2C110184%2C110185%2C109419%2C110077%2C110102%2C110225%2C110103%2C110226%2C217806%2C110254%2C110135%2C110259%2C110137%2C110138%2C110261%2C110264%2C110142%2C110346%2C110268%2C110281%2C110416&filter_3_0=13200&rp_submit=t
# end of TODO


def get_gks_weekly(day: datetime) -> pd.DataFrame:
    """
    Return weekly price on this day.

    :param day: day to detirmine week
    :return: pd.DataFrame
    """